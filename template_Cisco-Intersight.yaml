zabbix_export:
  version: '6.0'
  date: '2022-07-11T13:21:14Z'
  groups:
    -
      uuid: 763811688ed043bfb25fe1b71c52bfcf
      name: intersight
    -
      uuid: 75af14cc10ae4b269ab1a4e7f7083927
      name: Templates/Intersight
  templates:
    -
      uuid: 4839908406fb41b7aca123ff4b5ee199
      template: 'Cisco Intersight'
      name: 'Cisco Intersight'
      description: |
        This templates shall connect to Intersight by a single dummy host. Create the dummy host with interface type "agent", IP Address 127.0.0.1 and Agent port 0 and link this Template to Dummy host. You may execute all Items on dummy host to speed up Discovery Processes.
         
        This suite of templates, discovers Fabric Interconnect, Chassis, Blade & Rack and all subcomponent within before mentioned, but can be expanded to anything Intersight controls like IKS, ICO, IWO.
      groups:
        -
          name: Templates/Intersight
      items:
        -
          uuid: 9c5480e00bba472d8fcdfd0ef6a1403b
          name: 'Blade Servers JSON'
          type: EXTERNAL
          key: 'isctl["get", "compute", "blade"]'
          delay: 1h
          history: 1d
          trends: '0'
          value_type: TEXT
          description: 'Used in Discovery rule'
          tags:
            -
              tag: payload
              value: JSON
        -
          uuid: d17e89b50f2549d79efe1ed784034d2d
          name: 'Rack Servers JSON'
          type: EXTERNAL
          key: 'isctl["get", "compute", "rackunit"]'
          delay: 1h
          history: 1d
          trends: '0'
          value_type: TEXT
          description: 'Used in Discovery rule'
          tags:
            -
              tag: payload
              value: JSON
        -
          uuid: e1b9c01a0a09483d90eda22f42f8268c
          name: 'Blade Chassis JSON'
          type: EXTERNAL
          key: 'isctl["get", "equipment", "chassis"]'
          delay: 1h
          history: 1d
          trends: '0'
          value_type: TEXT
          description: 'Used in Discovery rule Chassis'
          tags:
            -
              tag: payload
              value: JSON
        -
          uuid: 7b3c155c18dd43ed98ec265017b34956
          name: 'Network Elements JSON'
          type: EXTERNAL
          key: 'isctl["get", "network", "elementsummary", "--select","Moid,Name,SwitchType"]'
          delay: 1h
          trends: '0'
          value_type: TEXT
          description: |
            Used for Autodiscover
            
            This ITEM can potentially detect all type of Network Elements, not just Fabric Interconnect. Each Autodiscover rule should filter on SwitchType to match the right Equipment Template.
          tags:
            -
              tag: payload
              value: JSON
        -
          uuid: e5c01a0b756f443eae34c5f1b4c7be35
          name: 'IKS Clusters JSON'
          type: EXTERNAL
          key: 'isctl["iks", "cluster", "list"]'
          delay: 1h
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: payload
              value: JSON
      discovery_rules:
        -
          uuid: 1aa4dac8a71f48e3b5b8eabc54a9276e
          name: 'Cisco Intersight Blade Servers'
          type: DEPENDENT
          key: intersight.compute.blade
          delay: '0'
          host_prototypes:
            -
              uuid: f6598790cf514c0f98a318d65f82db30
              host: '{#MOID}'
              name: '{#NAME}'
              group_links:
                -
                  group:
                    name: intersight
              group_prototypes:
                -
                  name: '{#TYPE}'
              templates:
                -
                  name: 'Cisco Intersight Bladeservers'
              tags:
                -
                  tag: ClassId
                  value: compute.Blade
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "compute", "blade"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#NAME}'
              path: $.Name
            -
              lld_macro: '{#TYPE}'
              path: $.ObjectType
        -
          uuid: 9467682b9acf46c49083af976f1da84b
          name: 'Cisco Intersight Rack Servers'
          type: DEPENDENT
          key: intersight.compute.rackunits
          delay: '0'
          host_prototypes:
            -
              uuid: 7cb1c2c6d0b6479289c8a52face7a801
              host: '{#MOID}'
              name: '{#NAME}'
              group_links:
                -
                  group:
                    name: intersight
              group_prototypes:
                -
                  name: '{#TYPE}'
              templates:
                -
                  name: 'Cisco Intersight Rackservers'
              tags:
                -
                  tag: ClassId
                  value: compute.RackUnit
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "compute", "rackunit"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#NAME}'
              path: $.Name
            -
              lld_macro: '{#TYPE}'
              path: $.ObjectType
        -
          uuid: c2c43d28da2e44579e4333163a266f15
          name: 'Cisco Intersight Chassis'
          type: DEPENDENT
          key: intersight.equipment.chassis
          delay: '0'
          host_prototypes:
            -
              uuid: cea293ba1315417982713480686b3354
              host: '{#MOID}'
              name: 'Chassis: {#NAME}'
              group_links:
                -
                  group:
                    name: intersight
              group_prototypes:
                -
                  name: '{#TYPE}'
              templates:
                -
                  name: 'Cisco Intersight Blade Chassis'
              tags:
                -
                  tag: ClassId
                  value: equipment.Chassis
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "equipment", "chassis"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#NAME}'
              path: $.Name
            -
              lld_macro: '{#TYPE}'
              path: $.ObjectType
        -
          uuid: e896e1b3c43549838c2ef93b34897919
          name: 'Cisco Intersight Fabric Interconnects'
          type: DEPENDENT
          key: intersight.network.element.fabricinterconnects
          delay: '0'
          filter:
            conditions:
              -
                macro: '{#TYPE}'
                value: FabricInterConnect
                formulaid: A
          host_prototypes:
            -
              uuid: 5332ab454c55425cbee36bbf88133895
              host: '{#MOID}'
              name: '{#NAME}'
              group_links:
                -
                  group:
                    name: intersight
              group_prototypes:
                -
                  name: '{#TYPE}'
              templates:
                -
                  name: 'Cisco Intersight Fabric Interconnects'
              tags:
                -
                  tag: ClassId
                  value: network.Element
                -
                  tag: SwitchType
                  value: FabricInterconnect
              inventory_mode: AUTOMATIC
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--select","Moid,Name,SwitchType"]'
          lld_macro_paths:
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#NAME}'
              path: $.Name
            -
              lld_macro: '{#TYPE}'
              path: $.SwitchType
      tags:
        -
          tag: 'START HERE'
    -
      uuid: 07287944debb4d97b9b739615cf83629
      template: 'Cisco Intersight Blade Chassis'
      name: 'Cisco Intersight Blade Chassis'
      groups:
        -
          name: Templates/Intersight
      items:
        -
          uuid: 433bcfcc8e5a45ceaaf1c626ff81f89f
          name: ConnectionPath
          type: DEPENDENT
          key: intersight.equipment.chassis.connectionpath
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ConnectionPath
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 33b136b1a51443f597af6bbac08f46fa
          name: ConnectionStatus
          type: DEPENDENT
          key: intersight.equipment.chassis.connectionstatus
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ConnectionStatus
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 9a47dae1fc424ec59f1b0cca34cefcce
          name: ManagementMode
          type: DEPENDENT
          key: intersight.equipment.chassis.managementmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ManagementMode
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 3275f7110d194f71b1091fb7769cc894
          name: Model
          type: DEPENDENT
          key: intersight.equipment.chassis.model
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: HARDWARE
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Model
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 9ad494f03fbd42b79aabecaec821be3a
          name: PartNumber
          type: DEPENDENT
          key: intersight.equipment.chassis.partnumber
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: HARDWARE_FULL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..PartNumber
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: f184bf67a76147b8a4e1259c0ff5e676
          name: PlatformType
          type: DEPENDENT
          key: intersight.equipment.chassis.platformtype
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..PlatformType
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 7383a518a7684a678a377c1849ccb2fc
          name: Serial
          type: DEPENDENT
          key: intersight.equipment.chassis.serial
          delay: '0'
          history: 1d
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Serial
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 29c44f1040e74ab8b1767ee9d2cf1df5
          name: Vendor
          type: DEPENDENT
          key: intersight.equipment.chassis.vendor
          delay: '0'
          history: 1d
          trends: '0'
          value_type: TEXT
          inventory_link: VENDOR
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Vendor
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
        -
          uuid: 6888cb6f224741d8a3df5c1b75ad489c
          name: 'Chassis JSON'
          type: EXTERNAL
          key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            Used for running Discovery rules
            
            isctl get equipment chassis --filter "Moid eq '5d043f5a6176752d311de58d'" --expand 'Blades($select=Name,Moid)'
            
            Expand Blades, used to get Moid, Name from each Bladeunit, select is used to limit the result
      discovery_rules:
        -
          uuid: 62b84138652043f68c83d8a15950b7f5
          name: Fanmodules
          type: DEPENDENT
          key: intersight.compute.chassis.fans
          delay: '0'
          item_prototypes:
            -
              uuid: a205e7212e9e428c84de884f988e4bc1
              name: 'Fan {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#FANMOID}''"]'
              delay: 15m
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                CLI Command
                
                isctl get cond alarm --filter "Fansmodule.Moid eq '5effb6d86176752d34ab0428'"
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.FanModule
              trigger_prototypes:
                -
                  uuid: b3ad2e68c485483ab873c36d3aac6ea3
                  expression: 'in(last(/Cisco Intersight Blade Chassis/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#FANMOID}''"]),"No Active Alarms")=0'
                  name: 'Fan {#ID} - Active Alarms'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
          lld_macro_paths:
            -
              lld_macro: '{#FANMOID}'
              path: $.Moid
            -
              lld_macro: '{#ID}'
              path: $.id
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Fanmodules']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 4d4c366a85994669b6446c8712da8707
          name: 'PSU modules'
          type: DEPENDENT
          key: intersight.compute.chassis.psus
          delay: '0'
          item_prototypes:
            -
              uuid: fee615bc6c124de281ddc83e86d3c823
              name: 'PSU {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#PSUMOID}''"]'
              delay: 15m
              history: 1d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.Psu
              trigger_prototypes:
                -
                  uuid: f8df26cdbedc417b8a58911bd12e133a
                  expression: 'in(last(/Cisco Intersight Blade Chassis/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#PSUMOID}''"]),"No Active Alarms")=0'
                  name: 'PSU {#ID} - Active Alarms'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "equipment", "chassis", "--filter", "Moid eq ''{HOST.HOST}''","--expand", "Blades"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#PSUMOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Psus']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: intersight
    -
      uuid: 14bdaeaac7eb48ca80eda6b4c65b14a8
      template: 'Cisco Intersight Bladeservers'
      name: 'Cisco Intersight Bladeservers'
      templates:
        -
          name: 'Cisco Intersight HCL'
      groups:
        -
          name: intersight
        -
          name: Templates/Intersight
      items:
        -
          uuid: 97908395367e45fd95d56a2c33f6602f
          name: Operability
          type: DEPENDENT
          key: intersight.compute.blade.operability
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Operability
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 326c45a96b8c4130b3914c4c310771cc
          name: OperState
          type: DEPENDENT
          key: intersight.compute.blade.operstate
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperState
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: STR_REPLACE
              parameters:
                - '""'
                - '<empty>'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: d09c7f4ba92b42f4993363f7d03920b1
              expression: 'in(last(/Cisco Intersight Bladeservers/intersight.compute.blade.operstate),"","ok","power-off")=0'
              name: 'OperState was detected as {ITEM.LASTVALUE}'
              opdata: 'OperState is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: 72df9deaf1f44cb88ca7bfae71af4d8d
          name: Vendor
          type: DEPENDENT
          key: intersight.compute.blade.vendor
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: VENDOR
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Vendor
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: aebea610f7d74b12b2db946e235969ef
          name: ManagementMode
          type: DEPENDENT
          key: intersight.compute.managementmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ManagementMode
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: f1db029fede44870b25c08b5e0945bdd
          name: MgmtIpAddress
          type: DEPENDENT
          key: intersight.compute.mgmtipaddress
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OOB_IP
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..MgmtIpAddress
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: ee019dcdfb5a4dbfab9bfbdcfca48378
          name: PowerState
          type: DEPENDENT
          key: intersight.compute.powerstate
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperPowerState
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 460ee04f04df4551a30ff44839bf0c81
              expression: 'in(last(/Cisco Intersight Bladeservers/intersight.compute.powerstate),"on")=0'
              name: 'PowerState is not on'
              priority: INFO
        -
          uuid: 44bec83184614ebf83b7bab38c9f9a96
          name: 'Compute Serial Number'
          type: DEPENDENT
          key: intersight.compute.serialnumber
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Serial
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: acdb1bc046694da49806d1188b8a6e4f
          name: 'Bladeunit JSON'
          type: EXTERNAL
          key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            Used for running Discovery rules
            
            isctl get compute blade moid 59a5a5a1103b880001653567
          triggers:
            -
              uuid: 09562ae900144669ae45259d49d03456
              expression: 'in(last(/Cisco Intersight Bladeservers/isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]),"operable")=0'
              name: 'Operability is not detected as operable'
              opdata: 'Operability is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
              manual_close: 'YES'
        -
          uuid: 5573b23a063448cf98b28f3ad19f7cf7
          name: 'Alarms on Compute Unit'
          type: EXTERNAL
          key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{HOST.HOST}''"]'
          delay: 5m
          trends: '0'
          value_type: LOG
          description: |
            isctl["get", "cond", "alarm", "—filter", "AffectedMoId eq '{HOST.HOST}'"]
            
            Example CLI Commandisctl get cond alarm --filter "AffectedMoId eq '5a2ba72929378e00019e3e8d'"
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Description
              error_handler: CUSTOM_VALUE
              error_handler_params: 'All good'
            -
              type: TRIM
              parameters:
                - '[]"'
          triggers:
            -
              uuid: d397225788b1486887e56a173f67e3b4
              expression: 'in(last(/Cisco Intersight Bladeservers/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{HOST.HOST}''"]),"All good")=0'
              name: 'Alarms on Compute Unit - {ITEM.LASTVALUE}'
              opdata: 'Alarms on Compute unit is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
      discovery_rules:
        -
          uuid: 4bc63280df31498e9777db4112656447
          name: LocatorLed
          type: DEPENDENT
          key: intersight.compute.blade.locaterled
          delay: '0'
          item_prototypes:
            -
              uuid: a41ba22e9acf4f1ab6bcde7bc2c5bb69
              name: 'Locator Led Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#LOCATORLEDMOID}''"]'
              delay: 15m
              trends: '0'
              value_type: TEXT
          master_item:
            key: 'isctl["get", "compute", "blade", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#LOCATORLEDMOID}'
              path: $.LocatorLed.Moid
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: intersight
    -
      uuid: 9ccf2ee8df0b4031bb13ebcbc06eb1d1
      template: 'Cisco Intersight Fabric Interconnects'
      name: 'Cisco Intersight Fabric Interconnects'
      groups:
        -
          name: Templates/Intersight
      items:
        -
          uuid: b84fd2afc41344a89c8a0a26f0b93b92
          name: EthernetMode
          type: DEPENDENT
          key: intersight.network.element.ethernetmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..EthernetMode
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 59e4126190e546b6ab32239f01d5afda
          name: EthernetSwitchingMode
          type: DEPENDENT
          key: intersight.network.element.ethernetswitchingmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..EthernetSwitchingMode
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: c08df36fb2cc4e9aa06c733f24baa4ee
          name: FaultSummary
          type: DEPENDENT
          key: intersight.network.element.faultsummary
          delay: '0'
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..FaultSummary
            -
              type: TRIM
              parameters:
                - '[]'
            -
              type: CHANGE_PER_SECOND
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 9f575a8157b0423892cf1a935d9e8605
          name: FcMode
          type: DEPENDENT
          key: intersight.network.element.fcmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..FcMode
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 69a6078fe4dc4c0894ffa4f5351eb855
          name: FcSwitchingMode
          type: DEPENDENT
          key: intersight.network.element.fcswitchingmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..FcSwitchingMode
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 0bce34ff3cc540d0a5864c1ddffa3120
          name: Firmware
          type: DEPENDENT
          key: intersight.network.element.firmware
          delay: '0'
          trends: '0'
          value_type: TEXT
          description: 'Firmware version'
          inventory_link: SOFTWARE
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Firmware
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: ca073ed56d17432ebffe94ba427a2b4b
          name: ManagementMode
          type: DEPENDENT
          key: intersight.network.element.managementmode
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ManagementMode
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: a55b41b242af40d0ab31bdd75956c77f
          name: Model
          type: DEPENDENT
          key: intersight.network.element.model
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Model
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 17a0d6f415b741729c6ae7368d0a531f
          name: Operability
          type: DEPENDENT
          key: intersight.network.element.operability
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Operability
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: c281c9015ff3420da74f4066fa278e27
              expression: 'in(last(/Cisco Intersight Fabric Interconnects/intersight.network.element.operability),"operable")=0'
              name: 'Operability is not operable'
              opdata: 'Operability is detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: 030ca8840c2b4f60b6b4b0dc3b7bc411
          name: OperEvacState
          type: DEPENDENT
          key: intersight.network.element.operevacstate
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperEvacState
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 2d093a33f1ca4536a89a6a1124ee1228
              expression: 'in(last(/Cisco Intersight Fabric Interconnects/intersight.network.element.operevacstate),"off")=0'
              name: 'OperEvacState is not off'
              opdata: 'OperEvacState is detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: c8f8841257f34895bed5bd2a3df2e51c
          name: OutOfBandIpAddress
          type: DEPENDENT
          key: intersight.network.element.outoffbandipaddress
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OOB_IP
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OutOfBandIpAddress
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 49d0f2c53ea14555aba83e982d60f64f
          name: OutOfBandIpGateway
          type: DEPENDENT
          key: intersight.network.element.outoffbandipgateway
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OOB_ROUTER
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OutOfBandIpGateway
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 1b0000f97c55416f948f4ba2000f5fa6
          name: OutOfBandIpMask
          type: DEPENDENT
          key: intersight.network.element.outoffbandipmask
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OOB_NETMASK
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OutOfBandIpMask
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: d2270af7e79e47869763edfcc5440f37
          name: OutOfBandMac
          type: DEPENDENT
          key: intersight.network.element.outoffbandmac
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OutOfBandMac
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 1ddf15a48c65484ba7419530e9e3b6a6
          name: Serial
          type: DEPENDENT
          key: intersight.network.element.serial
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Serial
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 77547c66d7404a6fa7fd90c58909cc17
          name: SwitchId
          type: DEPENDENT
          key: intersight.network.element.switchid
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..SwitchId
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 5a3d73d072024ca08f0104f1b05f59a6
          name: Vendor
          type: DEPENDENT
          key: intersight.network.element.vendor
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: VENDOR
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Vendor
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: b56638d905884269a57031d09626f05b
          name: Version
          type: DEPENDENT
          key: intersight.network.element.version
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: SOFTWARE_FULL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Version
            -
              type: TRIM
              parameters:
                - '[]"'
            -
              type: DISCARD_UNCHANGED
              parameters:
                - ''
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 9245d4f7479b4337983a49238231a772
          name: 'Alarms on Network Element'
          type: EXTERNAL
          key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{HOST.HOST}''"]'
          delay: 5m
          trends: '0'
          value_type: LOG
          description: |
            isctl["get", "cond", "alarm", "—filter", "AffectedMoId eq '{HOST.HOST}'"]
            
            Example CLI Commandisctl get cond alarm --filter "AffectedMoId eq '5a2ba72929378e00019e3e8d'"
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Description
              error_handler: CUSTOM_VALUE
              error_handler_params: 'All good'
            -
              type: TRIM
              parameters:
                - '[]"'
          tags:
            -
              tag: payload
              value: JSON
        -
          uuid: eca0c59e825442da974429e4999798e9
          name: 'Network Element JSON'
          type: EXTERNAL
          key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            Used for running Discovery rules
            
            isctl get network element' --filter "Moid eq '5d043ddf6176752d311d3f56'"
          tags:
            -
              tag: payload
              value: JSON
      discovery_rules:
        -
          uuid: 6ef9e3ee7d5f46a4befb82c2368ac795
          name: 'PSU modules'
          type: DEPENDENT
          key: intersight.network.element.psus
          delay: '0'
          item_prototypes:
            -
              uuid: 534ad34bb7d34cda8b45a8b63e2b116e
              name: 'PSU {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#PSUMOID}''"]'
              delay: '{$FREQUENCY}'
              history: 14d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.Psu
              trigger_prototypes:
                -
                  uuid: 82dc13c9f2704c3c8b7340bfadbece77
                  expression: 'in(last(/Cisco Intersight Fabric Interconnects/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#PSUMOID}''"]),"No Active Alarms")=0'
                  name: 'PSU {#ID} - Active Alarms (See History for details)'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#PSUMOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Psus']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 4e39d8e0833048b8972e848f705f0413
          name: Fanmodules
          type: DEPENDENT
          key: intersight.network.equipment.fanmodules
          delay: '0'
          item_prototypes:
            -
              uuid: fa3949d3e346474f9f446645a469a425
              name: 'Fan {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#FANMOID}''"]'
              delay: '{$FREQUENCY}'
              history: 14d
              trends: '0'
              value_type: TEXT
              description: |
                CLI Command
                
                isctl get cond alarm --filter "Fansmodule.Moid eq '5effb6d86176752d34ab0428'"
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: equipment.FanModule
              trigger_prototypes:
                -
                  uuid: 8d9cb2da584d4732b078f4b5cf3ceed9
                  expression: 'in(last(/Cisco Intersight Fabric Interconnects/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#FANMOID}''"]),"No Active Alarms")=0'
                  name: 'Fan {#ID} - Active Alarms (See History for details)'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#FANMOID}'
              path: $.Moid
            -
              lld_macro: '{#ID}'
              path: $.id
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Fanmodules']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 6ace1abc00e04630855f5726bb7a4ae0
          name: StorageItems
          type: DEPENDENT
          key: intersight.network.equipment.storageitems
          delay: '0'
          item_prototypes:
            -
              uuid: c6a912b830a94b91b3b79a03af7bfb1b
              name: 'StorageItem {#ID} - Active Alarms'
              type: EXTERNAL
              key: 'isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#STORAGEMOID}''"]'
              delay: '{$FREQUENCY}'
              history: 14d
              trends: '0'
              value_type: TEXT
              preprocessing:
                -
                  type: STR_REPLACE
                  parameters:
                    - '[]'
                    - 'No Active Alarms'
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                -
                  tag: ObjectType
                  value: storage.Item
              trigger_prototypes:
                -
                  uuid: 6c6083d73d854deea83d75527ce4e4a5
                  expression: 'in(last(/Cisco Intersight Fabric Interconnects/isctl["get", "cond", "alarm", "--filter", "AffectedMoId eq ''{#STORAGEMOID}''"]),"No Active Alarms")=0'
                  name: 'Storage {#ID} - Active Alarms (See History for details)'
                  priority: WARNING
          master_item:
            key: 'isctl["get", "network", "elementsummary", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#STORAGEMOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['StorageItems']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: intersight
      macros:
        -
          macro: '{$FREQUENCY}'
          value: 1h
          description: 'Fetch freq. for Subitems Fans, Storage, PSUs etc'
    -
      uuid: c10593b45cf449c29678f233dc0aaa4d
      template: 'Cisco Intersight HCL'
      name: 'Cisco Intersight HCL'
      groups:
        -
          name: intersight
        -
          name: Templates/Intersight
      items:
        -
          uuid: 71203c3978e341c6823a72d01675b09d
          name: HardwareStatus
          type: DEPENDENT
          key: intersight.hcl.hardwarestatus
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HardwareStatus
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: 8dbeb7253124442189adf34e662c94c5
              expression: 'find(/Cisco Intersight HCL/intersight.hcl.hardwarestatus,,"like","Validated")=0'
              name: 'HCL Hardwarestatus: {ITEM.LASTVALUE}'
              priority: WARNING
              tags:
                -
                  tag: AlarmType
                  value: HCL
        -
          uuid: d855bc1c34774ff09b55b752627ca9e0
          name: HclModel
          type: DEPENDENT
          key: intersight.hcl.hclmodel
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: MODEL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HclModel
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: f8265ed14cd54fceb12d065de0c9bbab
          name: HclOsVendor
          type: DEPENDENT
          key: intersight.hcl.hclosvendor
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OS
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HclOsVendor
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: e6e6b7f42d394336909f782e598ed678
          name: HclProcessor
          type: DEPENDENT
          key: intersight.hcl.hclprocessor
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: HW_ARCH
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..HclProcessor
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: 0b59ab70afb44d7eb181054eb4bcddcf
          name: InvFirmwareVersion
          type: DEPENDENT
          key: intersight.hcl.invfirmwareversion
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: SOFTWARE
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..InvFirmwareVersion
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: 9c5f97e827824b4f9e588cabf56f420c
          name: InvOsVersion
          type: DEPENDENT
          key: intersight.hcl.invosversion
          delay: '0'
          trends: '0'
          value_type: TEXT
          inventory_link: OS_FULL
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..InvOsVersion
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
        -
          uuid: 996d59e5646f4fb2a34bf2eecc3d1b7a
          name: ServerReason
          type: DEPENDENT
          key: intersight.hcl.serverreason
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ServerReason
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: 64f9a64f751a4c22a0ad2e83ee67415c
              expression: 'find(/Cisco Intersight HCL/intersight.hcl.serverreason,,"like","Compatible")=0'
              name: 'HCL Reason: {ITEM.LASTVALUE}'
              priority: WARNING
              tags:
                -
                  tag: AlarmType
                  value: HCL
        -
          uuid: 71bd0e82572d4b509fb51f645b645ecc
          name: SoftwareStatus
          type: DEPENDENT
          key: intersight.hcl.softwarestatus
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..SoftwareStatus
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: bc095435c9044260a2c5ea077fdfb01a
              expression: 'in(last(/Cisco Intersight HCL/intersight.hcl.softwarestatus),"Validated")=0'
              name: 'HCL SoftwareStatus not Validated'
              opdata: 'HCL SoftwareStatus is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: e69d02d66d394a04bc3319f386079ec3
          name: Status
          type: DEPENDENT
          key: intersight.hcl.status
          delay: '0'
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Status
            -
              type: LTRIM
              parameters:
                - '["'
            -
              type: RTRIM
              parameters:
                - '"]'
          master_item:
            key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          tags:
            -
              tag: ClassId
              value: cond.HclStatus
          triggers:
            -
              uuid: a0e5634509384a59a30c1d963f12a5c7
              expression: 'in(last(/Cisco Intersight HCL/intersight.hcl.status),"Validated")=0'
              name: 'HCL Status not validated'
              event_name: 'HCL Status is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: 7c258e71bc0a48c28896071340209724
          name: 'HCL Status JSON'
          type: EXTERNAL
          key: 'isctl["get", "cond", "hclstatus", "--filter", "ManagedObject.Moid eq ''{HOST.HOST}''"]'
          delay: 60m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            CLI Command
            
            isctl get cond hclstatus --filter "ManagedObject.Moid eq '59a5a5a1103b880001653564'"
            
            isctl["get", "compute", "rackunit", "—filter", "Moid eq '59a5a5a1103b880001653567'"]
          tags:
            -
              tag: payload
              value: JSON
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: intersight
    -
      uuid: e4383eed3b9b4e87b522031ce0330abb
      template: 'Cisco Intersight Rackservers'
      name: 'Cisco Intersight Rackservers'
      templates:
        -
          name: 'Cisco Intersight HCL'
      groups:
        -
          name: intersight
        -
          name: Templates/Intersight
      items:
        -
          uuid: c297068bee90421ba5b2b8603dc2c805
          name: ManagementMode
          type: DEPENDENT
          key: intersight.compute.managementmode
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..ManagementMode
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: fff790f28b5246be9c095a00a63b5a43
          name: MgmtIpAddress
          type: DEPENDENT
          key: intersight.compute.mgmtipaddress
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          inventory_link: OOB_IP
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..MgmtIpAddress
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 88e3f096883547ee8cd98b88151df095
          name: Operability
          type: DEPENDENT
          key: intersight.compute.operability
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Operability
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 16040e47f378450d8d199fb1cfd32467
              expression: 'in(last(/Cisco Intersight Rackservers/intersight.compute.operability),"operable")=0'
              name: 'Operability is not detected as operable'
              opdata: 'Operability is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
              manual_close: 'YES'
        -
          uuid: 2a2f998d60364c3498304604ca839d88
          name: PowerState
          type: DEPENDENT
          key: intersight.compute.powerstate
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperPowerState
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 69e5cde16d2f473589c96d92a314ecd3
              expression: 'in(last(/Cisco Intersight Rackservers/intersight.compute.powerstate),"on")=0'
              name: 'PowerState is not on'
              priority: INFO
        -
          uuid: 0fef43f1656740ab95a18581841b5ae9
          name: OperState
          type: DEPENDENT
          key: intersight.compute.rackunit.operstate
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..OperState
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          triggers:
            -
              uuid: 7585368f59854337ae83151bd6b60041
              expression: 'in(last(/Cisco Intersight Rackservers/intersight.compute.rackunit.operstate),"ok","power-off")=0'
              name: 'OperState was detected as {ITEM.LASTVALUE}'
              opdata: 'OperState is now detected as {ITEM.LASTVALUE}'
              priority: WARNING
        -
          uuid: 2415339376c745db95a79643eb094d38
          name: Vendor
          type: DEPENDENT
          key: intersight.compute.rackunit.vendor
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          inventory_link: VENDOR
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Vendor
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: 8e6da14b047b4cbda4d48c7d0a65b2f3
          name: 'Compute Serial number'
          type: DEPENDENT
          key: intersight.compute.serialnumber
          delay: '0'
          history: 30d
          trends: '0'
          value_type: TEXT
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: JSONPATH
              parameters:
                - $..Serial
            -
              type: TRIM
              parameters:
                - '[]"'
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
        -
          uuid: a347ce22b2b041868f79ec473a8cf6c5
          name: 'Rackunit JSON'
          type: EXTERNAL
          key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          delay: 15m
          history: 1d
          trends: '0'
          value_type: TEXT
          description: |
            Used for running Discovery rules
            
            isctl get compute rackunit moid 59a5a5a1103b880001653567
          tags:
            -
              tag: payload
              value: JSON
        -
          uuid: c2b23d350b1743709c05bc5255ccf839
          name: 'Active Alarms JSON'
          type: EXTERNAL
          key: 'isctl["get", "cond", "alarm", "--filter", "AncestorMoId eq ''{HOST.HOST}''"]'
          delay: 5m
          history: 1d
          trends: '0'
          value_type: TEXT
          tags:
            -
              tag: payload
              value: JSON
      discovery_rules:
        -
          uuid: f8799743c5d346d7b8e56eaad1effd67
          name: Fanmodules
          type: DEPENDENT
          key: intersight.compute.rackunit.fans
          delay: '0'
          item_prototypes:
            -
              uuid: 1ef501b388804d8c94068de5d01d629d
              name: 'Fan {#ID}'
              type: DEPENDENT
              key: 'intersight.equipment.fanmodules.[{#FANMOID}]'
              delay: '0'
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                This item does nothing except create a tag for event correlation.
                
                API Link for this Object is:
                {#URL}
              preprocessing:
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              master_item:
                key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
              tags:
                -
                  tag: Moid
                  value: '{#FANMOID}'
                -
                  tag: ObjectType
                  value: equipment.FanModule
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#FANMOID}'
              path: $.Moid
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#URL}'
              path: $.link
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Fanmodules']
                  var i = 0
                  do {
                    data[i].id=i+1 // Array starts at 0 but Cisco names from 1 hence the +1
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 75213b52ac8e499e963d61cd75cd85b7
          name: LocatorLed
          type: DEPENDENT
          key: intersight.compute.rackunit.locaterled
          delay: '0'
          item_prototypes:
            -
              uuid: 4cfafa8a68a14cfa9371ad49ba9975ce
              name: 'Locator Led'
              type: DEPENDENT
              key: 'intersight.equipment.ledmodules.[{#LOCATORLEDMOID}]'
              delay: '0'
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                This item does nothing except create a tag for event correlation.
                
                API Link for this Object is:
                {#URL}
              preprocessing:
                -
                  type: TRIM
                  parameters:
                    - '[]"'
              master_item:
                key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
              tags:
                -
                  tag: Moid
                  value: '{#LOCATORLEDMOID}'
                -
                  tag: ObjectType
                  value: equipment.LocatorLed
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#LOCATORLEDMOID}'
              path: $.LocatorLed.Moid
        -
          uuid: aabfbdb8fe5e483b81ae424a395dec8d
          name: 'PSU modules'
          type: DEPENDENT
          key: intersight.compute.rackunit.psus
          delay: '0'
          item_prototypes:
            -
              uuid: 8fef8cead9054bd8b59037e6d0babd56
              name: 'PSU {#ID}'
              type: DEPENDENT
              key: 'intersight.equipment.psu.[{#PSUMOID}]'
              delay: '0'
              history: 1d
              trends: '0'
              value_type: TEXT
              description: |
                This item does nothing except create a tag for event correlation.
                
                API Link for this Object is:
                {#URL}
              preprocessing:
                -
                  type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              master_item:
                key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
              tags:
                -
                  tag: Moid
                  value: '{#PSUMOID}'
                -
                  tag: ObjectType
                  value: equipment.Psu
          master_item:
            key: 'isctl["get", "compute", "rackunit", "--filter", "Moid eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#ID}'
              path: $.id
            -
              lld_macro: '{#PSUMOID}'
              path: $.Moid
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value)[0]['Psus']
                  var i = 0
                  do {
                    data[i].id=i
                    i++
                    console.log(i)
                  }
                  while (i < data.length)
                  return JSON.stringify(data)
        -
          uuid: 6904f70fb5a546ca828804b00fe31f7e
          name: 'Active Alarms'
          type: DEPENDENT
          key: intersight.cond.alarm
          delay: '0'
          item_prototypes:
            -
              uuid: c83e6284b07b4e92a7e8c2099fbe117a
              name: '{#SEVERITY}: {#DESCRIPTION}'
              type: DEPENDENT
              key: 'intersight.cond.alarm.[{#MOID}]'
              delay: '0'
              trends: '0'
              value_type: TEXT
              description: |
                Code: {#CODE}
                Severity: {#ORIGSEVERITY}
                CreateTime: {#CREATETIME}
                Acknowledged: {#ACKNOWLEDGE} - By: {#ACKNOWLEDGEBY}
              preprocessing:
                -
                  type: JSONPATH
                  parameters:
                    - '$[?(@.Moid == ''{#MOID}'')].Severity.first()'
              master_item:
                key: 'isctl["get", "cond", "alarm", "--filter", "AncestorMoId eq ''{HOST.HOST}''"]'
              tags:
                -
                  tag: classId
                  value: '{#CLASSID}'
                -
                  tag: moid
                  value: '{#MOID}'
              trigger_prototypes:
                -
                  uuid: 384e77e7115c437d9e8b1bac6b5f5578
                  expression: 'in("Cleared",last(/Cisco Intersight Rackservers/intersight.cond.alarm.[{#MOID}]))=0'
                  name: 'Alarm: {#DESCRIPTION}'
                  opdata: 'Is alarm still detected: {LAST.ITEMVALUE}'
          master_item:
            key: 'isctl["get", "cond", "alarm", "--filter", "AncestorMoId eq ''{HOST.HOST}''"]'
          lld_macro_paths:
            -
              lld_macro: '{#ACKNOWLEDGEBY}'
              path: $.AcknowledgeBy
            -
              lld_macro: '{#ACKNOWLEDGETIME}'
              path: $.AcknowledgeTime
            -
              lld_macro: '{#ACKNOWLEDGE}'
              path: $.Acknowledge
            -
              lld_macro: '{#AFFECTEDMOID}'
              path: $.AffectedMoId
            -
              lld_macro: '{#ANCESTORMOID}'
              path: $.AncestorMoId
            -
              lld_macro: '{#CLASSID}'
              path: $.ClassId
            -
              lld_macro: '{#CODE}'
              path: $.Code
            -
              lld_macro: '{#CREATETIME}'
              path: $.CreateTime
            -
              lld_macro: '{#DESCRIPTION}'
              path: $.Description
            -
              lld_macro: '{#LASTTRANSITIONTIME}'
              path: $.LastTransitionTime
            -
              lld_macro: '{#MOID}'
              path: $.Moid
            -
              lld_macro: '{#ORIGSEVERITY}'
              path: $.OrigSeverity
            -
              lld_macro: '{#SEVERITY}'
              path: $.Severity
          overrides:
            -
              name: 'Dont discover Cleared Items'
              step: '4'
              stop: STOP
              filter:
                conditions:
                  -
                    macro: '{#SEVERITY}'
                    value: Cleared
                    formulaid: A
              operations:
                -
                  operationobject: ITEM_PROTOTYPE
                  operator: LIKE
                  value: Cleared
                  discover: NO_DISCOVER
            -
              name: 'Trigger Severity Critical'
              step: '2'
              stop: STOP
              filter:
                conditions:
                  -
                    macro: '{#SEVERITY}'
                    value: Critical
                    formulaid: A
              operations:
                -
                  operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Alarm
                  severity: HIGH
            -
              name: 'Trigger Severity Warning'
              step: '1'
              stop: STOP
              filter:
                conditions:
                  -
                    macro: '{#SEVERITY}'
                    value: Warning
                    formulaid: A
              operations:
                -
                  operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Alarm
                  severity: WARNING
            -
              name: 'Trigger severity info'
              step: '3'
              stop: STOP
              filter:
                conditions:
                  -
                    macro: '{#SEVERITY}'
                    value: Info
                    formulaid: A
              operations:
                -
                  operationobject: TRIGGER_PROTOTYPE
                  operator: LIKE
                  value: Alarm
                  severity: INFO
      tags:
        -
          tag: class
          value: hardware
        -
          tag: target
          value: cisco
        -
          tag: target
          value: intersight
      macros:
        -
          macro: '{$FREQUENCY}'
          value: 1h
          description: 'Fetch freq. for Subitems Fans, Storage, PSUs etc'
  triggers:
    -
      uuid: f885bbff30be43009e4cb7ea201e900b
      expression: 'last(/Cisco Intersight Blade Chassis/intersight.equipment.chassis.connectionstatus)<>last(/Cisco Intersight Blade Chassis/intersight.equipment.chassis.connectionpath)=1'
      name: 'ConnectionStatus needs investigation'
      priority: WARNING
      description: 'Compare connectionStatus with ConnectionPath, if not equal, something might be wrong'
